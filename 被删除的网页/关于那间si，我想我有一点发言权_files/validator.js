!function(r){function n(n,o){r.isFunction(o.clearAllError)&&o.clearAllError(n);var l=!0;return r.each(o.rules,function(r,e){i(n,r,o)||(l=!1)}),l}function i(n,i,o){var l=n.find("[name="+i+"]"),e=o.rules[i];for(var a in e)if(e.hasOwnProperty(a)&&e[a]){var t=l.val(),s=r.isFunction(o.ruleFuns[a])&&o.ruleFuns[a](t);if(!s){var c=o.messages[a];return"string"!=typeof c&&(c=c[i]||""),o.showMessage&&r.isFunction(o.showFieldError)&&o.showFieldError(l,c),o.showMessage&&r.isFunction(o.showFieldErrorCallback)&&o.showFieldErrorCallback(l,c),!1}}return o.showMessage&&r.isFunction(o.clearFieldError)&&o.clearFieldError(l),o.showMessage&&r.isFunction(o.clearFieldErrorCallback)&&o.clearFieldErrorCallback(l),!0}function o(n){var i={};return n.find("[name]").each(function(){var o=r(this),l=o.attr("data-rules"),e=o.attr("name");if(l)try{i[e]=r.parseJSON(l)}catch(r){console.error(new SyntaxError("form[name="+n.attr("name")+"]'s field[name="+e+"]'s data-rules is not a validate json"))}}),i}var l=window.dui||{},e={form:null,rules:null,events:[],showMessage:!0,showFieldError:function(r,n){r.siblings(".tips-error").remove(),r.parent().append('<div class="tips tips-error">'+n+"</div>")},showFieldErrorCallback:null,showGlobalError:function(r,n){var i=r.find(".field-tips").html("");i.append("<div>"+n+"</div>")},showGlobalErrorCallback:null,clearGlobalError:function(r){r.find(".field-tips").html("")},clearGlobalErrorCallback:null,clearFieldError:function(r){r.siblings(".tips-error").remove()},clearFieldErrorCallback:null,clearAllError:function(r){r.find(".field-tips").html(""),r.find(".tips-error").remove()},clearAllErrorCallback:null,ruleFuns:{required:function(n){return!!r.trim(n)},phone:function(r){return!r||/^1\d{10}$/.test(r)},email:function(r){return!r||/^([a-zA-Z0-9_\.\-\+])+\@(\w)+([\.-]\w+)+$/.test(r)},alias:function(r){return/^\d+$/.test(r)?this.phone(r):this.email(r)||this.name(r)},pwd:function(r){return r&&r.length>=6},loginPwd:function(r){return r},name:function(r){return r&&r.replace(/[^\x00-\xff]/g,"**").length<=14}},messages:{required:"必填",phone:"手机号码格式错误",email:"邮箱格式错误",alias:"手机号 / 邮箱格式不正确",loginPwd:"密码最短6位",pwd:"密码最短6位",name:"名号长度不能超过14个英文或7个汉字"}},a=function(n){this._config=r.extend(!0,{},e,{rules:o(r(n.form))},n)};a.prototype={init:function(){var o=this._config,l=r(o.form);return l.on("submit",function(){return n(l,o)}),r.each(o.rules||[],function(n,e){var a=l.find("[name="+n+"]");r.each(o.events||[],function(r,e){a.on(e,function(){i(l,n,o)})})}),this},isValidate:function(i){return i=r.extend({},this._config,i),n(r(i.form),i)},isFieldValidate:function(n,o){o=r.extend({},this._config,o);var l=r(o.form),e=n;return"string"!=typeof e&&(e=e.attr("name")),i(l,e,o)},showFieldError:function(n,i){var o=this._config,l=r(o.form),e=n;return"string"==typeof e&&(e=l.find("[name="+e+"]")),r.isFunction(o.showFieldError)&&o.showFieldError(e,i),r.isFunction(o.showFieldErrorCallback)&&o.showFieldErrorCallback(e,i),this},showGlobalError:function(n,i){var o=this._config;r.isFunction(o.showGlobalError)&&o.showGlobalError(n,i),r.isFunction(o.showGlobalErrorCallback)&&o.showGlobalErrorCallback(n,i)},clearGlobalError:function(n){var i=this._config;r.isFunction(i.clearGlobalError)&&i.clearGlobalError(n),r.isFunction(i.clearGlobalErrorCallback)&&i.clearGlobalErrorCallback(n)},clearAllError:function(){var n=r(this._config.form);return r.isFunction(this._config.clearAllError)&&this._config.clearAllError(n),r.isFunction(this._config.clearAllErrorCallback)&&this._config.clearAllErrorCallback(n),this},clearFieldError:function(n){var i=r(this._config.form),o=n;return"string"==typeof o&&(o=i.find("[name="+o+"]")),r.isFunction(this._config.clearFieldError)&&this._config.clearFieldError(o),r.isFunction(this._config.clearFieldErrorCallback)&&this._config.clearFieldErrorCallback(o),this}},l.Validator=a,window.dui=l}(jQuery);